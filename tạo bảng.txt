CREATE DATABASE QLKQSV

CREATE TABLE GIANGVIEN
(
	MAGV VARCHAR(255) NOT NULL,
	HOTEN NVARCHAR(255) NOT NULL,
	SDT VARCHAR(255),

	PRIMARY KEY(MAGV)
)

CREATE TABLE KHOA
(
	MAKHOA VARCHAR(255) NOT NULL,
	TENKHOA NVARCHAR(255) NOT NULL,
	NAMTL DATE NOT NULL,
	PHONG VARCHAR(255) NOT NULL,
	SDT VARCHAR(255) NOT NULL,
	MATRUONGKHOA VARCHAR(255) NOT NULL,

	PRIMARY KEY (MAKHOA)
)

CREATE TABLE LAMVIEC
(
	MAGV VARCHAR(255) NOT NULL,
	MAKHOA VARCHAR(255) NOT NULL,

	PRIMARY KEY(MAGV, MAKHOA)
)

CREATE TABLE CHUYENNGANH
(
	MACN VARCHAR(255) NOT NULL,
	TENCN NVARCHAR(255) NOT NULL,
	MAKHOA VARCHAR(255) NOT NULL,
	MA_QL VARCHAR(255) NOT NULL,

	PRIMARY KEY(MACN)
)

CREATE TABLE MONTHI
(
	MAMT VARCHAR(255) NOT NULL,
	TENMT NVARCHAR(255) NOT NULL,

	PRIMARY KEY(MAMT)
)

CREATE TABLE MON_CHUYENNGANH
(
	MAMT VARCHAR(255) NOT NULL,
	MACN VARCHAR(255) NOT NULL,

	PRIMARY KEY(MAMT, MACN)
)

CREATE TABLE LOP
(
	MALOP VARCHAR(255) NOT NULL,
	SISO INT NOT NULL,
	MACN VARCHAR(255) NOT NULL,

	PRIMARY KEY(MALOP)
)


CREATE TABLE SINHVIEN
(
	MSSV VARCHAR(255) NOT NULL,
	HOTEN NVARCHAR(50) NOT NULL,
	SONHA NVARCHAR(255),
	DUONG NVARCHAR(255),
	QUAN NVARCHAR(255),
	TP NVARCHAR(255),
	NGAYSINH DATE NOT NULL,
	GIOITINH NVARCHAR(3) NOT NULL,
	MALOP VARCHAR(255) NOT NULL,

	PRIMARY KEY(MSSV),
)


CREATE TABLE SINHVIEN_SDT
(
	SDT VARCHAR(255),
	MSSV VARCHAR(255) NOT NULL
) 

CREATE TABLE THI
(
	MSSV VARCHAR(255) NOT NULL,
	MAMT VARCHAR(255) NOT NULL,
	DIEM FLOAT NOT NULL,
	GHICHU NVARCHAR(255),

	PRIMARY KEY(MSSV, MAMT)
)

ALTER TABLE KHOA
ADD CONSTRAINT FK_KHOA_GIANGVIEN
FOREIGN KEY (MATRUONGKHOA)
REFERENCES GIANGVIEN (MAGV)

ALTER TABLE LAMVIEC
ADD CONSTRAINT FK_LAMVIEC_GIANGVIEN
FOREIGN KEY (MAGV)
REFERENCES GIANGVIEN (MAGV)

ALTER TABLE LAMVIEC
ADD CONSTRAINT FK_LAMVIEC_KHOA
FOREIGN KEY (MAKHOA)
REFERENCES KHOA (MAKHOA)

ALTER TABLE CHUYENNGANH
ADD CONSTRAINT FK_CHUYENNGANH_KHOA
FOREIGN KEY (MAKHOA)
REFERENCES KHOA (MAKHOA)

ALTER TABLE CHUYENNGANH
ADD CONSTRAINT FK_CHUYENNGANH_GIANGVIEN
FOREIGN KEY (MA_QL)
REFERENCES GIANGVIEN (MAGV)

ALTER TABLE MON_CHUYENNGANH
ADD CONSTRAINT FK_MCN_MONTHI
FOREIGN KEY (MAMT)
REFERENCES MONTHI (MAMT)

ALTER TABLE MON_CHUYENNGANH
ADD CONSTRAINT FK_MCN_CHUYENNGANH
FOREIGN KEY (MACN)
REFERENCES CHUYENNGANH (MACN)

ALTER TABLE LOP
ADD CONSTRAINT FK_LOP_CHUYENNGANH
FOREIGN KEY (MACN)
REFERENCES CHUYENNGANH (MACN)

ALTER TABLE SINHVIEN
ADD CONSTRAINT FK_SINHVIEN_LOP
FOREIGN KEY (MALOP)
REFERENCES LOP (MALOP)

ALTER TABLE SINHVIEN_SDT
ADD CONSTRAINT FK_SINHVIEN_SDT
FOREIGN KEY (MSSV)
REFERENCES SINHVIEN (MSSV)

ALTER TABLE THI
ADD CONSTRAINT FK_THI_SINHVIEN
FOREIGN KEY (MSSV)
REFERENCES SINHVIEN (MSSV)

ALTER TABLE THI
ADD CONSTRAINT FK_THI_MONTHI
FOREIGN KEY (MAMT)
REFERENCES MONTHI (MAMT)
